artifactory:
  splitServicesToContainers: false
  ingress:
    enabled: true
    defaultBackend:
      enabled: true
    hosts:
      - {{ fqdn }}
    routerPath: /
    artifactoryPath: /artifactory/
    className: "nginx-global"
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-gcp
      external-dns.alpha.kubernetes.io/hostname: {{ fqdn }}
      nginx.ingress.kubernetes.io/proxy-body-size: "0"
    labels:
      traffic-type: external
    tls:
      - secretName: tls.{{ fqdn }}
        hosts:
          - {{ fqdn }}
  global:
    masterKey: {{ artifactory['master_key'] }}
    joinKey: {{ artifactory['join_key'] }}
{#    customInitContainers: |#}
{#     - name: "fix-join-key"#}
{#       image: ubuntu:latest#}
{#       imagePullPolicy: IfNotPresent#}
{#       command:#}
{#         - /bin/bash#}
{#         - -c#}
{#         - echo -n ${ARTIFACTORY_JOIN_KEY} > /opt/jfrog/artifactory/var/etc/security/join.key#}
{#       volumeMounts:#}
{#         - mountPath: "/var/opt/jfrog/artifactory"#}
{#           name: artifactory-volume#}
{#       env:#}
{#       - name: ARTIFACTORY_JOIN_KEY#}
{#         valueFrom:#}
{#           secretKeyRef:#}
{#             key: join-key#}
{#             name: artifactory#}
  serviceAccount:
    create: true
  nginx:
    enabled: false
  artifactory:
    admin:
      ip: {{ artifactory['ip'] }}
      username: {{ artifactory['admin_user'] }}
      password: {{ artifactory['admin_pass'] }}
{#    customPersistentVolumeClaim:#}
{#      name: "artifactory-security"#}
{#      mountPath: "/opt/jfrog/artifactory/var/etc/security"#}
{#      accessModes:#}
{#       - "ReadWriteOnce"#}
{#      size: 5Mi#}
{#      storageClassName: ceph-filesystem#}
    persistence:
      enabled: true
{#      mountPath: "/opt/jfrog/artifactory"#}
      existingClaim: artifactory-data-volume
      storageClassName: ceph-filesystem
      size: 20Gi
    database:
      maxOpenConnections: 150
    tomcat:
      connector:
        maxThreads: 300
    resources:
      requests:
        memory: "6Gi"
        cpu: "2"
      limits:
        memory: "10Gi"
        cpu: "8"
    javaOpts:
      xms: "8g"
      xmx: "10g"
  access:
    database:
      maxOpenConnections: 150
    tomcat:
      connector:
        maxThreads: 100
  router:
    resources:
      requests:
        memory: "200Mi"
        cpu: "200m"
      limits:
        memory: "1Gi"
        cpu: "1"
  frontend:
    resources:
      requests:
        memory: "200Mi"
        cpu: "200m"
      limits:
        memory: "1Gi"
        cpu: "1"
  metadata:
    database:
      maxOpenConnections: 150
    resources:
      requests:
        memory: "200Mi"
        cpu: "200m"
      limits:
        memory: "1Gi"
        cpu: "1"
  event:
    resources:
      requests:
        memory: "200Mi"
        cpu: "200m"
      limits:
        memory: "1Gi"
        cpu: "1"
  jfconnect:
    resources:
      requests:
        memory: "200Mi"
        cpu: "200m"
      limits:
        memory: "1Gi"
        cpu: "1"
  integration:
    resources:
      requests:
        memory: "200Mi"
        cpu: "200m"
      limits:
        memory: "1Gi"
        cpu: "1"
  observability:
    resources:
      requests:
        memory: "200Mi"
        cpu: "200m"
      limits:
        memory: "1Gi"
        cpu: "1"
  postgresql:
    enabled: true
{#  database:#}
{#    type: postgresql#}
{#    driver: org.postgresql.Driver#}
{#    url: "jdbc:postgresql://dbs-cockroachdb-public.dbs:26257/artifactory?sslmode=disable&user=root"#}
{#    secrets:#}
{#      user:#}
{#        name: root#}
{#        key: root#}